# Python Tools ç›®å½•è¯´æ˜

æœ¬ç›®å½•å°†åŒ…å«ä½¿ç”¨ Python å¼€å‘çš„å„ç§ DevOps å·¥å…·å’Œè„šæœ¬ã€‚

## ğŸš§ å¼€å‘çŠ¶æ€

å½“å‰æ­¤ç›®å½•å¤„äºè§„åˆ’é˜¶æ®µï¼Œå°†é€æ­¥æ·»åŠ å®ç”¨çš„ Python å·¥å…·ã€‚

## ğŸ“‹ è®¡åˆ’å¼€å‘çš„å·¥å…·

### 1. log_analyzer.py - æ—¥å¿—åˆ†æå·¥å…·
**åŠŸèƒ½**ï¼š
- è§£æå’Œåˆ†æå„ç§æ ¼å¼çš„æ—¥å¿—æ–‡ä»¶
- ç»Ÿè®¡é”™è¯¯ã€è­¦å‘Šå’Œå…³é”®äº‹ä»¶
- ç”Ÿæˆæ—¥å¿—åˆ†ææŠ¥å‘Š
- æ”¯æŒæ—¶é—´èŒƒå›´è¿‡æ»¤
- å¼‚å¸¸æ¨¡å¼è¯†åˆ«

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ•…éšœæ’æŸ¥
- æ€§èƒ½åˆ†æ
- å®‰å…¨å®¡è®¡
- è¶‹åŠ¿åˆ†æ

### 2. metrics_collector.py - æŒ‡æ ‡æ”¶é›†å™¨
**åŠŸèƒ½**ï¼š
- æ”¶é›†ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡
- è‡ªå®šä¹‰æŒ‡æ ‡é‡‡é›†
- æ•°æ®æ ¼å¼è½¬æ¢
- æ—¶åºæ•°æ®å¤„ç†
- å¯¼å‡ºåˆ°ç›‘æ§ç³»ç»Ÿ

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ€§èƒ½ç›‘æ§
- å®¹é‡è§„åˆ’
- è¶‹åŠ¿åˆ†æ
- å‘Šè­¦è§¦å‘

### 3. alert_manager.py - å‘Šè­¦ç®¡ç†å·¥å…·
**åŠŸèƒ½**ï¼š
- å‘Šè­¦è§„åˆ™ç®¡ç†
- å¤šæ¸ é“å‘Šè­¦é€šçŸ¥ï¼ˆEmailã€Slackã€é’‰é’‰ã€ä¼ä¸šå¾®ä¿¡ï¼‰
- å‘Šè­¦èšåˆå’Œå»é‡
- å‘Šè­¦å‡çº§æœºåˆ¶
- å‘Šè­¦å†å²è®°å½•

**ä½¿ç”¨åœºæ™¯**ï¼š
- ç›‘æ§å‘Šè­¦
- äº‹ä»¶å“åº”
- æ•…éšœé€šçŸ¥
- SLA ç®¡ç†

### 4. config_validator.py - é…ç½®éªŒè¯å·¥å…·
**åŠŸèƒ½**ï¼š
- éªŒè¯é…ç½®æ–‡ä»¶æ ¼å¼
- æ£€æŸ¥é…ç½®é¡¹å®Œæ•´æ€§
- é…ç½®å®‰å…¨æ£€æŸ¥
- é…ç½®ç‰ˆæœ¬å¯¹æ¯”
- ç”Ÿæˆé…ç½®æŠ¥å‘Š

**ä½¿ç”¨åœºæ™¯**ï¼š
- é…ç½®ç®¡ç†
- å˜æ›´å®¡è®¡
- å®‰å…¨åˆè§„
- éƒ¨ç½²å‰æ£€æŸ¥

### 5. resource_optimizer.py - èµ„æºä¼˜åŒ–å·¥å…·
**åŠŸèƒ½**ï¼š
- åˆ†æèµ„æºä½¿ç”¨æƒ…å†µ
- è¯†åˆ«èµ„æºæµªè´¹
- æä¾›ä¼˜åŒ–å»ºè®®
- æˆæœ¬ä¼°ç®—
- å®¹é‡è§„åˆ’

**ä½¿ç”¨åœºæ™¯**ï¼š
- æˆæœ¬ä¼˜åŒ–
- æ€§èƒ½è°ƒä¼˜
- å®¹é‡è§„åˆ’
- èµ„æºç®¡ç†

### 6. backup_manager.py - å¤‡ä»½ç®¡ç†å·¥å…·
**åŠŸèƒ½**ï¼š
- è‡ªåŠ¨åŒ–å¤‡ä»½ä»»åŠ¡
- å¤‡ä»½å®Œæ•´æ€§éªŒè¯
- å¤‡ä»½ä¿ç•™ç­–ç•¥
- å¢é‡å¤‡ä»½æ”¯æŒ
- æ¢å¤æµ‹è¯•

**ä½¿ç”¨åœºæ™¯**ï¼š
- æ•°æ®å¤‡ä»½
- ç¾éš¾æ¢å¤
- åˆè§„è¦æ±‚
- æ•°æ®å½’æ¡£

## ğŸ“ å¼€å‘è§„èŒƒ

### Python ç‰ˆæœ¬
- Python 3.8+

### ä»£ç é£æ ¼
- éµå¾ª PEP 8 è§„èŒƒ
- ä½¿ç”¨ç±»å‹æç¤ºï¼ˆType Hintsï¼‰
- è¯¦ç»†çš„æ–‡æ¡£å­—ç¬¦ä¸²

### é¡¹ç›®ç»“æ„
```python
#!/usr/bin/env python3
"""
å·¥å…·åç§°

ç®€è¦æè¿°å·¥å…·çš„åŠŸèƒ½å’Œç”¨é€”ã€‚

Author: xxx
Version: x.x.x
License: MIT
"""

import argparse
import logging
from typing import Dict, List, Optional


class ToolName:
    """å·¥å…·ç±»æè¿°"""
    
    def __init__(self, config: Dict):
        """åˆå§‹åŒ–
        
        Args:
            config: é…ç½®å­—å…¸
        """
        self.config = config
        self.logger = self._setup_logger()
    
    def _setup_logger(self) -> logging.Logger:
        """è®¾ç½®æ—¥å¿—å™¨"""
        logger = logging.getLogger(__name__)
        handler = logging.StreamHandler()
        formatter = logging.Formatter(
            '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
        )
        handler.setFormatter(formatter)
        logger.addHandler(handler)
        logger.setLevel(logging.INFO)
        return logger
    
    def run(self) -> None:
        """ä¸»è¦æ‰§è¡Œé€»è¾‘"""
        pass


def main() -> None:
    """ä¸»å‡½æ•°"""
    parser = argparse.ArgumentParser(
        description='å·¥å…·æè¿°',
        formatter_class=argparse.RawDescriptionHelpFormatter
    )
    parser.add_argument(
        '-v', '--version',
        action='version',
        version='%(prog)s 1.0.0'
    )
    parser.add_argument(
        '-c', '--config',
        help='é…ç½®æ–‡ä»¶è·¯å¾„',
        type=str
    )
    
    args = parser.parse_args()
    
    # æ‰§è¡Œå·¥å…·é€»è¾‘
    tool = ToolName(config={})
    tool.run()


if __name__ == '__main__':
    main()
```

### ä¾èµ–ç®¡ç†
```bash
# ä½¿ç”¨ requirements.txt ç®¡ç†ä¾èµ–
pip install -r requirements.txt

# æˆ–ä½¿ç”¨ Poetry
poetry install
```

### ç¤ºä¾‹ requirements.txt
```txt
# æ—¥å¿—å’Œç›‘æ§
loguru>=0.7.0
prometheus-client>=0.17.0

# æ•°æ®å¤„ç†
pandas>=2.0.0
numpy>=1.24.0

# ç½‘ç»œå’Œ API
requests>=2.31.0
aiohttp>=3.8.0

# é…ç½®ç®¡ç†
pyyaml>=6.0
python-dotenv>=1.0.0

# å‘½ä»¤è¡Œå·¥å…·
click>=8.1.0
rich>=13.0.0

# æµ‹è¯•
pytest>=7.4.0
pytest-cov>=4.1.0
```

### æµ‹è¯•è§„èŒƒ
```python
# tests/test_tool.py
import pytest
from tool import ToolName


def test_initialization():
    """æµ‹è¯•å·¥å…·åˆå§‹åŒ–"""
    tool = ToolName(config={})
    assert tool is not None


def test_main_åŠŸèƒ½():
    """æµ‹è¯•ä¸»è¦åŠŸèƒ½"""
    tool = ToolName(config={})
    result = tool.run()
    assert result is not None
```

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### æ—¥å¿—åˆ†æå·¥å…·ç¤ºä¾‹
```bash
# åˆ†ææœ€è¿‘1å°æ—¶çš„é”™è¯¯æ—¥å¿—
python log_analyzer.py --log-file /var/log/app.log --level ERROR --hours 1

# ç”Ÿæˆ HTML æŠ¥å‘Š
python log_analyzer.py --log-file /var/log/app.log --output report.html

# ç›‘æ§å®æ—¶æ—¥å¿—
python log_analyzer.py --log-file /var/log/app.log --follow --alert
```

### æŒ‡æ ‡æ”¶é›†å™¨ç¤ºä¾‹
```bash
# æ”¶é›†ç³»ç»ŸæŒ‡æ ‡
python metrics_collector.py --interval 60 --output metrics.json

# å‘é€åˆ° Prometheus Pushgateway
python metrics_collector.py --push --gateway http://localhost:9091
```

### å‘Šè­¦ç®¡ç†å™¨ç¤ºä¾‹
```bash
# å‘é€å‘Šè­¦
python alert_manager.py --level critical --message "æœåŠ¡å™¨è´Ÿè½½è¿‡é«˜"

# é…ç½®å‘Šè­¦è§„åˆ™
python alert_manager.py --config alerts.yaml --validate
```

## ğŸ”§ å¼€å‘ç¯å¢ƒè®¾ç½®

### 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
# ä½¿ç”¨ venv
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows

# ä½¿ç”¨ conda
conda create -n devops-tools python=3.11
conda activate devops-tools
```

### 2. å®‰è£…å¼€å‘ä¾èµ–
```bash
pip install -r requirements-dev.txt
```

### 3. é…ç½®ä»£ç æ£€æŸ¥å·¥å…·
```bash
# å®‰è£… pre-commit
pip install pre-commit
pre-commit install

# .pre-commit-config.yaml
repos:
  - repo: https://github.com/psf/black
    rev: 23.3.0
    hooks:
      - id: black
  - repo: https://github.com/PyCQA/flake8
    rev: 6.0.0
    hooks:
      - id: flake8
  - repo: https://github.com/PyCQA/isort
    rev: 5.12.0
    hooks:
      - id: isort
```

## ğŸ“š æ¨èåº“

### ç³»ç»Ÿå’Œè¿›ç¨‹
- `psutil` - ç³»ç»Ÿå’Œè¿›ç¨‹å·¥å…·
- `sh` - æ‰§è¡Œ shell å‘½ä»¤

### ç½‘ç»œå’Œ API
- `requests` - HTTP å®¢æˆ·ç«¯
- `httpx` - å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
- `paramiko` - SSH å®¢æˆ·ç«¯

### æ•°æ®å¤„ç†
- `pandas` - æ•°æ®åˆ†æ
- `numpy` - æ•°å€¼è®¡ç®—
- `jinja2` - æ¨¡æ¿å¼•æ“

### é…ç½®å’Œæ—¥å¿—
- `pyyaml` - YAML è§£æ
- `toml` - TOML è§£æ
- `loguru` - ä¼˜é›…çš„æ—¥å¿—åº“
- `structlog` - ç»“æ„åŒ–æ—¥å¿—

### å‘½ä»¤è¡Œç•Œé¢
- `click` - CLI æ¡†æ¶
- `typer` - ç°ä»£ CLI æ¡†æ¶
- `rich` - ç»ˆç«¯ç¾åŒ–
- `tqdm` - è¿›åº¦æ¡

### ç›‘æ§å’ŒæŒ‡æ ‡
- `prometheus-client` - Prometheus å®¢æˆ·ç«¯
- `statsd` - StatsD å®¢æˆ·ç«¯

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ® Python å·¥å…·ï¼

è´¡çŒ®æ—¶è¯·ç¡®ä¿ï¼š
1. ä»£ç ç¬¦åˆ PEP 8 è§„èŒƒ
2. åŒ…å«å®Œæ•´çš„æ–‡æ¡£å­—ç¬¦ä¸²
3. æ·»åŠ å•å…ƒæµ‹è¯•
4. æ›´æ–° requirements.txt
5. æä¾›ä½¿ç”¨ç¤ºä¾‹

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [ç”¨æˆ·æŒ‡å—](/docs/UserGuide.md)
- [æœ€ä½³å®è·µ](/docs/BestPractices.md)
- [Python å®˜æ–¹æ–‡æ¡£](https://docs.python.org/3/)
- [PEP 8 é£æ ¼æŒ‡å—](https://pep8.org/)

## ğŸ“® åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- GitHub Issues: https://github.com/sunyifei83/devops-toolkit/issues
- Email: sunyifei83@gmail.com

---

*æ­¤ç›®å½•æ­£åœ¨ç§¯æå¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼*
